{"version":3,"sources":["global-es2015.js","global.js","bem.js","global-functions.js"],"names":["siteHeaderPartial","node","settingsDropdown","querySelector","dropdownBackground","Bem","element","dropdownOpen","addEventListener","setState","setBurgerMenuState","popupPartial","opened","hasState","dataTriggers","data","split","forEach","trigger","document","dispatchEvent","CustomEvent","detail","elements","elem","burgerMenuBackgroundElement","formValidationForGlobalForms","form","startFormValidation","cookieConsent","date","Date","setTime","getTime","cookie","concat","toUTCString","style","display","window","bemClass","classList","length","i","includes","querySelectorAll","state","active","add","remove","contains","toggleState","toggle","hasModifier","modifier","getAttribute","hasData","hasAttribute","open","burgerMenuButton","burgerMenu","burgerMenuBackground","undefined","debounceFunction","func","debounce","timeout","context","this","args","arguments","later","apply","clearTimeout","setTimeout","formElement","validationFunctions","isNotEmpty","value","minLength","valData","Number","maxLength","isEmail","test","matches","RegExp","matchesProperty","namedItem","mustChange","submitButton","formElements","formErrorConfig","config","HTMLButtonElement","formContainer","closest","elementConfig","touched","valid","errors","errorMessages","children","errorMessage","errorName","push","generateFormErrorConfig","elementErrorConfig","updateElementState","defaultInvalid","error","isValid","disabled","every","elemErrConf","openDynamicPopup","async","popupUrl","insertionPoint","resp","fetch","innerHTML","text","setupPopupHandling","popupElem","firstChild","removeChild","lastChild","_event$submitter$getA","event","preventDefault","submitter","submitResp","action","method","headers","Content-Type","redirect","body","URLSearchParams","FormData","redirected","location","reload","autoAdjustFontSize","contextToCheck","desiredFontWidth","getComputedStyle","originalWidth","fontSize","replace","adjustedWidth","font","__autoFontSizeCanvas__","createElement","context2D","getContext","measureText","width","getTextWidth","innerText","popup"],"mappings":"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","file":"global-es2015.js","sourcesContent":[null,"// PARTIALS ---------------------------------------------------------------------------------------\r\n\r\n/**\r\n * @param {HTMLElement} node\r\n */\r\nfunction siteHeaderPartial(node) {\r\n\tif(!node) return;\r\n\r\n\tconst settingsDropdown = node.querySelector('.partial-settings-dropdown');\r\n\tconst dropdownBackground = Bem.element(node, 'dropdown-background');\r\n\r\n\tlet dropdownOpen = false;\r\n\tBem.element(node, 'dropdown-trigger').addEventListener('click', () => {\r\n\t\tdropdownOpen = !dropdownOpen;\r\n\t\tBem.setState(settingsDropdown, 'open', dropdownOpen);\r\n\t\tBem.setState(dropdownBackground, 'shown', dropdownOpen);\r\n\t});\r\n\r\n\tdropdownBackground.addEventListener('click', () => {\r\n\t\tdropdownOpen = false;\r\n\t\tBem.setState(settingsDropdown, 'open', dropdownOpen);\r\n\t\tBem.setState(dropdownBackground, 'shown', dropdownOpen);\r\n\t});\r\n\r\n\tBem.element(node, 'burger-menu').addEventListener('click', () => setBurgerMenuState());\r\n}\r\nsiteHeaderPartial(document.querySelector('.partial-site-header'));\r\n\r\n// ------------------------------------------------------------------------------------------------\r\n\r\n/**\r\n * @param {HTMLElement} node\r\n */\r\nfunction popupPartial(node) {\r\n\tif(!node) return;\r\n\r\n\tlet opened = Bem.hasState(node, 'open');\r\n\r\n\tconst dataTriggers = Bem.data(node, 'triggers');\r\n\r\n\tif (dataTriggers) {\r\n\t\tconst triggers = dataTriggers.split('::');\r\n\t\ttriggers.forEach(trigger => {\r\n\t\t\tdocument.querySelector(trigger).addEventListener('click', () => {\r\n\t\t\t\tif (!opened) {\r\n\t\t\t\t\tBem.setState(node, 'open', true);\r\n\t\t\t\t\topened = true;\r\n\t\t\t\t\tdocument.dispatchEvent(new CustomEvent('popup-opened', {detail: node}));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tBem.elements(node, 'close').forEach(elem => {\r\n\t\telem.addEventListener('click', () => {\r\n\t\t\tBem.setState(node, 'open', false);\r\n\t\t\topened = false;\r\n\t\t\tdocument.dispatchEvent(new CustomEvent('popup-closed', {detail: node}));\r\n\t\t});\r\n\t});\r\n}\r\ndocument.querySelectorAll('.partial-popup').forEach(popup => popupPartial(popup));\r\n\r\n// ------------------------------------------------------------------------------------------------\r\n\r\n/**\r\n * @param {HTMLElement} node\r\n */\r\nfunction burgerMenuBackgroundElement(node) {\r\n\tif(!node) return;\r\n\r\n\tnode.addEventListener('click', () => setBurgerMenuState(false));\r\n}\r\nburgerMenuBackgroundElement(document.querySelector('.partial-burger-menu__background'));\r\n\r\n// ------------------------------------------------------------------------------------------------\r\n\r\n/**\r\n * @param {HTMLFormElement} form\r\n */\r\nfunction formValidationForGlobalForms(form) {\r\n\tif (form.querySelector('button[type=\"submit\"]')) {\r\n\t\tstartFormValidation(form);\r\n\t}\r\n}\r\ndocument.querySelectorAll('form').forEach(form => formValidationForGlobalForms(form));\r\n\r\n// ------------------------------------------------------------------------------------------------\r\n\r\n/**\r\n * @param {HTMLElement} node\r\n */\r\nfunction cookieConsent(node) {\r\n\tif(!node) return;\r\n\r\n\tBem.element(node, 'btn').addEventListener('click', () => {\r\n\t\tconst date = new Date();\r\n\t\tdate.setTime(date.getTime() + (30 * 24 * 60 * 60 * 1000));\r\n\t\tdocument.cookie = `acceptedCookies=true; expires=${date.toUTCString()}; path=/`;\r\n\t\tnode.style.display = 'none';\r\n\t});\r\n}\r\ncookieConsent(document.querySelector('.partial-cookie-consent'));\r\n\r\n// GLOBAL_CALLS -----------------------------------------------------------------------------------\r\n\r\nautoAdjustFontSize(document.body);\r\n\r\n// ------------------------------------------------------------------------------------------------\r\n","window.Bem = {\r\n\r\n    /**\r\n     * @param {Element} node\r\n     * @returns {string}\r\n     */\r\n    bemClass(node) {\r\n        if (node.classList.length === 1) {\r\n            return node.classList[0];\r\n        } else {\r\n            for (let i = 0; i < node.classList.length; i++) {\r\n                if (!node.classList[i].includes('--')) {\r\n                    return node.classList[i];\r\n                }\r\n            }\r\n            return undefined;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * @param {Element} node\r\n     * @param {string} element\r\n     * @returns {Element}\r\n     */\r\n    element(node, element) {\r\n        const bemClass = Bem.bemClass(node);\r\n        return node.querySelector(`.${bemClass}__${element}`);\r\n    },\r\n\r\n\t/**\r\n\t * @param {Element} node\r\n\t * @param {string} element\r\n\t * @returns {NodeList<HTMLElement>}\r\n\t */\r\n\telements(node, element) {\r\n\t\tconst bemClass = Bem.bemClass(node);\r\n\t\treturn node.querySelectorAll(`.${bemClass}__${element}`);\r\n\t},\r\n\r\n    /**\r\n     * @param {Element} node\r\n     * @param {string} state\r\n     * @param {boolean} active\r\n     */\r\n    setState(node, state, active) {\r\n        if (active) {\r\n            node.classList.add(`is-${state}`);\r\n        } else {\r\n            node.classList.remove(`is-${state}`);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * @param {Element} node\r\n     * @param {string} state\r\n     * @returns {boolean}\r\n     */\r\n    hasState(node, state) {\r\n        return node.classList.contains(`is-${state}`);\r\n    },\r\n\r\n    /**\r\n     * @param {Element} node\r\n     * @param {string} state\r\n     */\r\n    toggleState(node, state) {\r\n        node.classList.toggle(`is-${state}`);\r\n    },\r\n\r\n    /**\r\n     * @param {Element} node\r\n     * @param {string} modifier\r\n     * @returns {boolean}\r\n     */\r\n    hasModifier(node, modifier) {\r\n        const bemClass = Bem.bemClass(node);\r\n        return node.classList.contains(`${bemClass}--${modifier}`);\r\n    },\r\n\r\n    /**\r\n     * @param {Element} node\r\n     * @param {string} data\r\n     * @returns {string}\r\n     */\r\n    data(node, data) {\r\n        return node.getAttribute(`data-${data}`);\r\n    },\r\n\r\n    /**\r\n     * @param {Element} node\r\n     * @param {string} data\r\n     * @returns {boolean}\r\n     */\r\n    hasData(node, data) {\r\n        return node.hasAttribute(`data-${data}`);\r\n    }\r\n};\r\n","/**\r\n * @param {boolean?} open toggle if undefined\r\n */\r\nwindow.setBurgerMenuState = function (open) {\r\n\tconst burgerMenuButton = document.querySelector('.partial-site-header__burger-menu');\r\n\tconst burgerMenu = document.querySelector('.partial-burger-menu');\r\n\tconst burgerMenuBackground = document.querySelector('.partial-burger-menu__background');\r\n\tif (open !== undefined) {\r\n\t\tBem.setState(burgerMenu, 'open', open);\r\n\t\tBem.setState(burgerMenuBackground, 'open', open);\r\n\t\tBem.setState(burgerMenuButton, 'open', open);\r\n\t} else {\r\n\t\topen = !Bem.hasState(burgerMenu, 'open');\r\n\t\tBem.setState(burgerMenu, 'open', open);\r\n\t\tBem.setState(burgerMenuBackground, 'open', open);\r\n\t\tBem.setState(burgerMenuButton, 'open', open);\r\n\t}\r\n};\r\n\r\n/**\r\n * @param {Function} func\r\n * @param {number} debounce\r\n * @return {Function}\r\n */\r\nwindow.debounceFunction = function (func, debounce) {\r\n\tlet timeout;\r\n\r\n\treturn function() {\r\n\t\tconst context = this;\r\n\t\tconst args = arguments;\r\n\r\n\t\tconst later = function() {\r\n\t\t\ttimeout = null;\r\n\t\t\tfunc.apply(context, args);\r\n\t\t};\r\n\r\n\t\tclearTimeout(timeout);\r\n\t\ttimeout = setTimeout(later, debounce);\r\n\t};\r\n};\r\n\r\n/**\r\n *\r\n * @param {HTMLFormElement} formElement\r\n */\r\nwindow.startFormValidation = function (formElement) {\r\n\tconst validationFunctions = {\r\n\t\tisNotEmpty: value => value !== undefined && value !== null && value !== '',\r\n\t\tminLength: (value, valData) => value.length >= Number(valData),\r\n\t\tmaxLength: (value, valData) => value.length <= Number(valData),\r\n\t\tisEmail: value => /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(value),\r\n\t\tmatches: (value, valData) => new RegExp(valData).test(value),\r\n\t\tmatchesProperty: (value, valData, elements) => elements.namedItem(valData).value === value,\r\n\t\tmustChange: (value, valData) => value !== valData\r\n\t};\r\n\r\n\tconst submitButton = formElement.querySelector('button[type=\"submit\"]');\r\n\tconst formElements = formElement.elements;\r\n\r\n\tconst formErrorConfig = generateFormErrorConfig(formElements);\r\n\r\n\tfor (const elementErrorConfig of formErrorConfig) {\r\n\t\tupdateElementState(elementErrorConfig, Bem.hasState(elementErrorConfig.formContainer, 'invalid'));\r\n\r\n\t\telementErrorConfig.element.addEventListener('input', () => {\r\n\t\t\telementErrorConfig.touched = true;\r\n\t\t\tupdateElementState(elementErrorConfig);\r\n\t\t});\r\n\t}\r\n\r\n\tfunction updateElementState(elementErrorConfig, defaultInvalid) {\r\n\t\telementErrorConfig.valid = true;\r\n\t\telementErrorConfig.errors.forEach(error => {\r\n\t\t\tconst isValid = validationFunctions[error.errorName](elementErrorConfig.element.value, error.valData, formElements);\r\n\t\t\tif (!isValid) elementErrorConfig.valid = false;\r\n\t\t\tBem.setState(error.errorMessage, 'shown', !isValid && elementErrorConfig.touched);\r\n\t\t});\r\n\t\tBem.setState(elementErrorConfig.formContainer, 'invalid', defaultInvalid || !elementErrorConfig.valid && elementErrorConfig.touched);\r\n\t\tsubmitButton.disabled = !formErrorConfig.every(elemErrConf => elemErrConf.valid);\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t * @param {HTMLFormControlsCollection} elements\r\n\t */\r\n\tfunction generateFormErrorConfig(elements) {\r\n\t\tconst config = [];\r\n\r\n\t\tfor (const element of elements) {\r\n\t\t\tif (element instanceof HTMLButtonElement) continue;\r\n\r\n\t\t\tconst formContainer = element.closest('div[form-container]');\r\n\r\n\t\t\tif (!formContainer) continue;\r\n\r\n\t\t\tconst elementConfig = {\r\n\t\t\t\tformContainer: formContainer,\r\n\t\t\t\telement: element,\r\n\t\t\t\ttouched: false,\r\n\t\t\t\tvalid: false,\r\n\t\t\t\terrors: []\r\n\t\t\t};\r\n\t\t\tconst errorMessages = elementConfig.formContainer.querySelector('div[form-errors]').children;\r\n\t\t\tfor (const errorMessage of errorMessages) {\r\n\t\t\t\tconst errorName = errorMessage.getAttribute('data-error');\r\n\r\n\t\t\t\tif (!(errorName in validationFunctions)) continue;\r\n\r\n\t\t\t\telementConfig.errors.push({\r\n\t\t\t\t\terrorName: errorName,\r\n\t\t\t\t\tvalData: errorMessage.getAttribute('data-val-data'),\r\n\t\t\t\t\terrorMessage: errorMessage\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tconfig.push(elementConfig);\r\n\t\t}\r\n\t\treturn config;\r\n\t}\r\n};\r\n\r\n/**\r\n * @param {string} popupUrl\r\n * @param {Element} insertionPoint\r\n */\r\nwindow.openDynamicPopup = async function (popupUrl, insertionPoint) {\r\n\tconst resp = await fetch(popupUrl);\r\n\tinsertionPoint.innerHTML = await resp.text();\r\n\tsetupPopupHandling();\r\n\r\n\tfunction setupPopupHandling() {\r\n\t\tconst popupElem = insertionPoint.querySelector('.partial-popup');\r\n\r\n\t\tif (popupElem.hasAttribute('data-js')) {\r\n\t\t\twindow[popupElem.getAttribute('data-js')](popupElem);\r\n\t\t}\r\n\r\n\t\tBem.elements(popupElem, 'close').forEach(elem => {\r\n\t\t\telem.addEventListener('click', () => {\r\n\t\t\t\twhile (insertionPoint.firstChild) {\r\n\t\t\t\t\tinsertionPoint.removeChild(insertionPoint.lastChild);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tconst formElement = popupElem.querySelector('form');\r\n\t\tif (!formElement) return;\r\n\r\n\t\tstartFormValidation(formElement);\r\n\t\tformElement.addEventListener('submit', async event => {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tif (event.submitter instanceof HTMLButtonElement) {\r\n\t\t\t\tevent.submitter.disabled = true;\r\n\t\t\t}\r\n\r\n\t\t\tconst submitResp = await fetch(event.submitter.getAttribute('formaction') ?? formElement.action, {\r\n\t\t\t\tmethod: formElement.method,\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded'\r\n\t\t\t\t},\r\n\t\t\t\tredirect: 'follow',\r\n\t\t\t\tbody: new URLSearchParams(new FormData(formElement))\r\n\t\t\t});\r\n\t\t\tif (submitResp.redirected) {\r\n\t\t\t\tinsertionPoint.innerHTML = await submitResp.text();\r\n\t\t\t\tsetupPopupHandling();\r\n\t\t\t} else {\r\n\t\t\t\tlocation.reload();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n};\r\n\r\n/**\r\n * @param {Element} contextToCheck\r\n */\r\nwindow.autoAdjustFontSize = function (contextToCheck) {\r\n\tcontextToCheck.querySelectorAll('[auto-font-size]').forEach(node => {\r\n\t\tconst desiredFontWidth = Number(node.getAttribute('auto-font-size'));\r\n\t\tconst style = window.getComputedStyle(node);\r\n\t\tconst originalWidth = Number(style.fontSize.replace('px', ''));\r\n\t\tconst textWidth = getTextWidth(node.innerText, style.font);\r\n\t\tconst adjustedWidth = originalWidth * (desiredFontWidth / textWidth);\r\n\r\n\t\tif (adjustedWidth < originalWidth) {\r\n\t\t\tnode.style.fontSize = adjustedWidth + 'px';\r\n\t\t}\r\n\r\n\t});\r\n\r\n\tfunction getTextWidth(text, font) {\r\n\t\tif (!window.__autoFontSizeCanvas__) {\r\n\t\t\twindow.__autoFontSizeCanvas__ = document.createElement('canvas');\r\n\t\t}\r\n\t\tconst context2D = window.__autoFontSizeCanvas__.getContext('2d');\r\n\t\tcontext2D.font = font ?? window.getComputedStyle(this.document.body).font;\r\n\t\treturn context2D.measureText(text).width;\r\n\t}\r\n};\r\n"]}