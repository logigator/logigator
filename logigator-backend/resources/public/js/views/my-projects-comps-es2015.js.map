{"version":3,"sources":["my-projects-comps-es2015.js"],"names":["projectComponentList","pageType","document","querySelector","getAttribute","popupContainer","pageContainer","pageButtons","querySelectorAll","pageButtonTargets","searchTerm","currentPage","updatePagination","projectCompList","totalPages","Number","Bem","data","from","to","undefined","Math","max","page","i","forEach","button","index","disabled","setState","innerHTML","async","navigate","search","params","searchParams","URLSearchParams","toString","resp","fetch","concat","text","baseUrl","location","protocol","host","pathname","join","window","history","pushState","autoAdjustFontSize","addInteractionButtonListeners","addEventListener","id","parentElement","openDynamicPopup","hasState","searchInput","getElementById","debouncedListener","debounceFunction","value","addSearchListener","viewProjectComponentSharePopup","node","linkCopyBtn","textArea","this","createElement","body","appendChild","select","execCommand","remove"],"mappings":"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","file":"my-projects-comps-es2015.js","sourcesContent":["function projectComponentList() {\r\n\tconst pageType = document.querySelector('.view-my-projects-comps').getAttribute('data-type');\r\n\tconst popupContainer = document.querySelector('.view-my-projects-comps__popup-container');\r\n\tconst pageContainer = document.querySelector('.view-my-projects-comps__list');\r\n\tconst pageButtons = document.querySelectorAll('.view-my-projects-comps__page-button');\r\n\tconst pageButtonTargets = [0, 0, 0, 0, 0, 0, 0];\r\n\r\n\tlet searchTerm;\r\n\tlet currentPage;\r\n\r\n\tfunction updatePagination() {\r\n\t\tconst projectCompList = document.querySelector('.partial-project-comp-list');\r\n\t\tconst totalPages = Number(Bem.data(projectCompList, 'total-pages'));\r\n\t\tcurrentPage = Number(Bem.data(projectCompList, 'current-page'));\r\n\r\n\t\tpageButtonTargets[0] = currentPage > 0 ? 0 : undefined;\r\n\t\tpageButtonTargets[1] = currentPage > 0 ? currentPage - 1 : undefined;\r\n\r\n\t\tpageButtonTargets[2] = undefined;\r\n\t\tpageButtonTargets[3] = undefined;\r\n\t\tpageButtonTargets[4] = undefined;\r\n\r\n\t\tlet from;\r\n\t\tlet to;\r\n\t\tif (currentPage === 0) {\r\n\t\t\tfrom = 0;\r\n\t\t\tto = totalPages > 3 ? 3 : totalPages - 1;\r\n\t\t} else if (currentPage === totalPages - 1) {\r\n\t\t\tfrom = Math.max(totalPages - 3, 0);\r\n\t\t\tto = totalPages - 1;\r\n\t\t} else {\r\n\t\t\tfrom = currentPage - 1;\r\n\t\t\tto = currentPage + 1;\r\n\t\t}\r\n\t\tfor (let page = from, i = 2; page <= to; page++, i++) {\r\n\t\t\tpageButtonTargets[i] = page;\r\n\t\t}\r\n\r\n\t\tpageButtonTargets[5] = currentPage < totalPages - 1 ? currentPage + 1 : undefined;\r\n\t\tpageButtonTargets[6] = currentPage < totalPages - 1 ? totalPages - 1 : undefined;\r\n\r\n\r\n\t\tpageButtons.forEach((button, index) => {\r\n\t\t\tif (index <= 1 || index >= 5) {\r\n\t\t\t\tbutton.disabled = pageButtonTargets[index] === undefined;\r\n\t\t\t} else {\r\n\t\t\t\tBem.setState(button, 'hidden', pageButtonTargets[index] === undefined);\r\n\t\t\t\tBem.setState(button, 'active', pageButtonTargets[index] === currentPage);\r\n\t\t\t\tbutton.innerHTML = pageButtonTargets[index] + 1;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tfunction addPageButtonListeners() {\r\n\t\tpageButtons.forEach((button, index) => {\r\n\t\t\tbutton.addEventListener('click', () => {\r\n\t\t\t\tif (pageButtonTargets[index] !== undefined && !Bem.hasState(button, 'active')) {\r\n\t\t\t\t\tnavigate(pageButtonTargets[index], searchTerm);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tfunction addSearchListener() {\r\n\t\tconst searchInput = document.getElementById('view-my-projects-comps__search');\r\n\t\tconst debouncedListener = debounceFunction(() => {\r\n\t\t\tsearchTerm = searchInput.value;\r\n\t\t\tnavigate(0, searchTerm);\r\n\t\t}, 400);\r\n\t\tsearchInput.addEventListener('input', debouncedListener);\r\n\t}\r\n\r\n\tasync function navigate(page, search) {\r\n\t\tconst params = {\r\n\t\t\tpage\r\n\t\t};\r\n\t\tif (search !== undefined && search !== '') {\r\n\t\t\tparams.search = search;\r\n\t\t}\r\n\r\n\t\tconst searchParams = new URLSearchParams(params).toString();\r\n\t\tconst resp = await fetch(`/my/${pageType}/page?${searchParams}`);\r\n\t\tpageContainer.innerHTML = await resp.text();\r\n\r\n\t\tconst baseUrl = [location.protocol, '//', location.host, location.pathname].join('');\r\n\t\twindow.history.pushState({}, '', baseUrl + '?' + searchParams);\r\n\t\tautoAdjustFontSize(pageContainer);\r\n\t\tupdatePagination();\r\n\t\taddInteractionButtonListeners(pageContainer);\r\n\t}\r\n\r\n\tfunction addInteractionButtonListeners() {\r\n\t\tpageContainer.querySelectorAll('.partial-project-comp-list__icon-info').forEach(button => {\r\n\t\t\tbutton.addEventListener('click', () => {\r\n\t\t\t\tconst id = button.parentElement.getAttribute('data-id');\r\n\t\t\t\topenDynamicPopup(`/my/${pageType}/info/${id}`, popupContainer);\r\n\t\t\t});\r\n\t\t});\r\n\t\tpageContainer.querySelectorAll('.partial-project-comp-list__icon-edit').forEach(button => {\r\n\t\t\tbutton.addEventListener('click', () => {\r\n\t\t\t\tconst id = button.parentElement.getAttribute('data-id');\r\n\t\t\t\topenDynamicPopup(`/my/${pageType}/edit-popup/${id}`, popupContainer);\r\n\t\t\t});\r\n\t\t});\r\n\t\tpageContainer.querySelectorAll('.partial-project-comp-list__icon-new').forEach(button => {\r\n\t\t\tbutton.addEventListener('click', () => {\r\n\t\t\t\topenDynamicPopup(`/my/${pageType}/create-popup`, popupContainer);\r\n\t\t\t});\r\n\t\t});\r\n\t\tpageContainer.querySelectorAll('.partial-project-comp-list__icon-delete').forEach(button => {\r\n\t\t\tbutton.addEventListener('click', () => {\r\n\t\t\t\tconst id = button.parentElement.getAttribute('data-id');\r\n\t\t\t\topenDynamicPopup(`/my/${pageType}/delete-popup/${id}`, popupContainer);\r\n\t\t\t});\r\n\t\t});\r\n\t\tpageContainer.querySelectorAll('.partial-project-comp-list__icon-share').forEach(button => {\r\n\t\t\tbutton.addEventListener('click', () => {\r\n\t\t\t\tconst id = button.parentElement.getAttribute('data-id');\r\n\t\t\t\topenDynamicPopup(`/my/${pageType}/share-popup/${id}`, popupContainer);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tupdatePagination();\r\n\taddPageButtonListeners();\r\n\taddSearchListener();\r\n\taddInteractionButtonListeners();\r\n}\r\nprojectComponentList();\r\n\r\n/**\r\n *\r\n * @param {Element} node\r\n */\r\nwindow.viewProjectComponentSharePopup = function (node) {\r\n\tconst linkCopyBtn = node.querySelector('.view-project-component-share-popup__link-copy');\r\n\tlinkCopyBtn.addEventListener('click', () => {\r\n\t\tconst textArea = this.document.createElement('textarea');\r\n\t\ttextArea.value = Bem.data(linkCopyBtn, 'link');\r\n\t\tthis.document.body.appendChild(textArea);\r\n\t\ttextArea.select();\r\n\t\tthis.document.execCommand('copy');\r\n\t\ttextArea.remove();\r\n\t});\r\n};\r\n"]}